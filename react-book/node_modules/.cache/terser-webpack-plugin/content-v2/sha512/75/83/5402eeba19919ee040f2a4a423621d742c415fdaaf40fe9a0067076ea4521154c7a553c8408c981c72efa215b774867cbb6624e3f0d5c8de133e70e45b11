{"map":"{\"version\":3,\"sources\":[\"/Users/shamopoo/Desktop/github/Notes/react-book/src/Comment/CommentInput.js\",\"/Users/shamopoo/Desktop/github/Notes/react-book/src/Comment/CommentInputContainer.js\",\"/Users/shamopoo/Desktop/github/Notes/react-book/src/reducers/comments.js\",\"/Users/shamopoo/Desktop/github/Notes/react-book/src/Comment/Comment.js\",\"/Users/shamopoo/Desktop/github/Notes/react-book/src/Comment/CommentList.js\",\"/Users/shamopoo/Desktop/github/Notes/react-book/src/Comment/CommentListContainer.js\",\"/Users/shamopoo/Desktop/github/Notes/react-book/src/Comment/CommentApp.js\",\"/Users/shamopoo/Desktop/github/Notes/react-book/src/index.js\"],\"names\":[\"CommentInput\",\"props\",\"_this\",\"Object\",\"classCallCheck\",\"this\",\"possibleConstructorReturn\",\"getPrototypeOf\",\"call\",\"state\",\"username\",\"content\",\"wordCounter\",\"refs\",\"textarea\",\"focus\",\"event\",\"setState\",\"target\",\"value\",\"onUserNameInputBlur\",\"e\",\"style\",\"height\",\"scrollHeight\",\"length\",\"onSubmit\",\"createdTime\",\"Math\",\"floor\",\"Date\",\"now\",\"react_default\",\"a\",\"createElement\",\"className\",\"maxLength\",\"onBlur\",\"handleUsernameBlur\",\"bind\",\"onChange\",\"handleUsernameChange\",\"ref\",\"handleContentChange\",\"onClick\",\"handleSubmit\",\"Component\",\"defaultProps\",\"CommentInputContainer\",\"_loadUsername\",\"localStorage\",\"getItem\",\"oldUserName\",\"setItem\",\"comment\",\"alert\",\"comments\",\"newComments\",\"concat\",\"toConsumableArray\",\"JSON\",\"stringify\",\"Comment_CommentInput\",\"_saveUsername\",\"handleSubmitComment\",\"connect\",\"dispatch\",\"console\",\"log\",\"type\",\"addComment\",\"Comment\",\"timeString\",\"_updateTimeString\",\"duration\",\"round\",\"max\",\"onDeleteComment\",\"index\",\"handleDeleteComment\",\"CommentList\",\"map\",\"i\",\"src_Comment_Comment\",\"key\",\"CommentListContainer\",\"_loadComments\",\"parse\",\"_unused\",\"initComments\",\"slice\",\"Comment_CommentList\",\"commentIndex\",\"deleteComment\",\"CommentApp\",\"Comment_CommentInputContainer\",\"Comment_CommentListContainer\",\"store\",\"createStore\",\"action\",\"ReactDOM\",\"render\",\"es\",\"Comment_CommentApp\",\"document\",\"getElementById\"],\"mappings\":\"0RAGMA,cASJ,SAAAA,EAAaC,GAAO,IAAAC,EAAA,OAAAC,OAAAC,EAAA,EAAAD,CAAAE,KAAAL,IACjBE,EAAAC,OAAAG,EAAA,EAAAH,CAAAE,KAAAF,OAAAI,EAAA,EAAAJ,CAAAH,GAAAQ,KAAAH,KAAMJ,KACDQ,MAAQ,CACVC,SAAUT,EAAMS,SAChBC,QAAS,GACTC,YAAa,KALCV,mFASlBG,KAAKI,MAAMC,UAAYL,KAAKQ,KAAKC,SAASC,qDAGtBC,GACpBX,KAAKY,SAAS,CACZP,SAAUM,EAAME,OAAOC,mDAIPH,GACdX,KAAKJ,MAAMmB,qBACbf,KAAKJ,MAAMmB,oBAAoBJ,EAAME,OAAOC,mDAI3BE,GACnBhB,KAAKQ,KAAKC,SAASQ,MAAMC,OAAS,OAClClB,KAAKQ,KAAKC,SAASQ,MAAMC,OAAUlB,KAAKQ,KAAKC,SAASU,aAAe,KACrEnB,KAAKY,SAAS,CACVN,QAASU,EAAEH,OAAOC,MAClBP,YAAa,IAAMS,EAAEH,OAAOC,MAAMM,gDAIjCpB,KAAKJ,MAAMyB,UACZrB,KAAKJ,MAAMyB,SAAS,CAChBhB,SAAUL,KAAKI,MAAMC,SACrBC,QAASN,KAAKI,MAAME,QACpBgB,YAAcC,KAAKC,OAAOC,KAAKC,MAAS,OAG/C1B,KAAKY,SAAS,CAACN,QAAS,sCAGzB,OACEqB,EAAAC,EAAAC,cAAA,MAAA,CAAKC,UAAU,iBACXH,EAAAC,EAAAC,cAAA,MAAA,CAAKC,UAAU,iBACbH,EAAAC,EAAAC,cAAA,OAAA,CAAMC,UAAU,sBAAhB,4BACAH,EAAAC,EAAAC,cAAA,MAAA,CAAKC,UAAU,uBACbH,EAAAC,EAAAC,cAAA,QAAA,CACIE,UAAW,KACXjB,MAAOd,KAAKI,MAAMC,SAClB2B,OAAQhC,KAAKiC,mBAAmBC,KAAKlC,MACrCmC,SAAUnC,KAAKoC,qBAAqBF,KAAKlC,UAGjD2B,EAAAC,EAAAC,cAAA,MAAA,CAAKC,UAAU,iBACbH,EAAAC,EAAAC,cAAA,OAAA,CAAMC,UAAU,sBAAhB,kCACAH,EAAAC,EAAAC,cAAA,MAAA,CAAKC,UAAU,uBACbH,EAAAC,EAAAC,cAAA,WAAA,CACIE,UAAU,OACVM,IAAI,WACJvB,MAAOd,KAAKI,MAAME,QAClB6B,SAAUnC,KAAKsC,oBAAoBJ,KAAKlC,UAGhD2B,EAAAC,EAAAC,cAAA,MAAA,CAAKC,UAAU,gBAAgB9B,KAAKI,MAAMG,YAA1C,WACAoB,EAAAC,EAAAC,cAAA,MAAA,CAAKC,UAAU,wBACbH,EAAAC,EAAAC,cAAA,SAAA,CAAQU,QAASvC,KAAKwC,aAAaN,KAAKlC,OAAxC,yBA5EeyC,EAAAA,WAArB9C,EAMG+C,aAAe,CACnBrC,SAAU,IA6EAV,IAAAA,EAAAA,ECjFTgD,cAMF,SAAAA,IAAe,IAAA9C,EAAA,OAAAC,OAAAC,EAAA,EAAAD,CAAAE,KAAA2C,IACZ9C,EAAAC,OAAAG,EAAA,EAAAH,CAAAE,KAAAF,OAAAI,EAAA,EAAAJ,CAAA6C,GAAAxC,KAAAH,QACKI,MAAQ,CACVC,SAAU,IAHDR,oFAQXG,KAAK4C,wDAIL,IAAIvC,EAAWwC,aAAaC,QAAQ,YACpCzC,GAAYL,KAAKY,SAAS,CAACP,SAAAA,0CAIhBA,GACb,IAAI0C,EAAcF,aAAaC,QAAQ,aAAe,GACtDzC,GAAY0C,IAAgB1C,GAAawC,aAAaG,QAAQ,WAAY3C,+CAGvD4C,GACnB,GAAKA,EAAL,CACA,IAAKA,EAAQ5C,SAAU,OAAO6C,MAAM,wCACpC,IAAKD,EAAQ3C,QAAS,OAAO4C,MAAM,8CAHP,IAIlBC,EAAanD,KAAKJ,MAAlBuD,SACFC,EAAW,GAAAC,OAAAvD,OAAAwD,EAAA,EAAAxD,CAAOqD,GAAP,CAAiBF,IAClCJ,aAAaG,QAAQ,WAAYO,KAAKC,UAAUJ,IAC5CpD,KAAKJ,MAAMyB,UACXrB,KAAKJ,MAAMyB,SAAS4B,qCAI1B,OACEtB,EAAAC,EAAAC,cAAC4B,EAAD,CACApD,SAAUL,KAAKI,MAAMC,SACrBU,oBAAqBf,KAAK0D,cAAcxB,KAAKlC,MAC7CqB,SAAUrB,KAAK2D,oBAAoBzB,KAAKlC,eA5CZyC,EAAAA,WAgErBmB,EAAAA,OAAAA,EAAAA,EAAAA,CAdS,SAACxD,GACvB,MAAO,CACL+C,SAAU/C,EAAM+C,WAIO,SAACU,GAC1B,MAAO,CACLxC,SAAU,SAAC4B,GACTY,EC7BoB,SAACZ,GAEzB,OADAa,QAAQC,IAAId,GACL,CAAEe,KApCS,cAoCUf,QAAAA,GD2BfgB,CAAWhB,OAKXW,CAGbjB,GEzBauB,cAvCb,SAAAA,IAAe,IAAArE,EAAA,OAAAC,OAAAC,EAAA,EAAAD,CAAAE,KAAAkE,IACbrE,EAAAC,OAAAG,EAAA,EAAAH,CAAAE,KAAAF,OAAAI,EAAA,EAAAJ,CAAAoE,GAAA/D,KAAAH,QACKI,MAAQ,CACT+D,WAAY,IAHHtE,oFAOXG,KAAKoE,gEAGP,IAAMnB,EAAUjD,KAAKJ,MAAMqD,QACrBoB,EAAW9C,KAAKC,OAAOC,KAAKC,MAAQ,IAAOuB,EAAQ3B,aACzDwC,QAAQC,IAAIM,GACZrE,KAAKY,SAAS,CACZuD,WAAYE,EAAW,GAAOA,EAAW,KAAWA,EAAW,MAAX,GAAAhB,OAA6B9B,KAAK+C,MAAMD,EAAW,GAAK,GAAK,IAA7D,iBAAA,GAAAhB,OAA2E9B,KAAK+C,MAAMD,EAAW,GAAK,IAAtG,uBAAtB,GAAAhB,OAA6I9B,KAAK+C,MAAMD,EAAW,IAAnK,uBAAlB,GAAAhB,OAAqM9B,KAAK+C,MAAM/C,KAAKgD,IAAIF,EAAU,IAAnO,iEAIRrE,KAAKJ,MAAM4E,iBACbxE,KAAKJ,MAAM4E,gBAAgBxE,KAAKJ,MAAM6E,wCAI1C,OACE9C,EAAAC,EAAAC,cAAA,MAAA,CAAKC,UAAU,WACbH,EAAAC,EAAAC,cAAA,MAAA,CAAKC,UAAU,gBACbH,EAAAC,EAAAC,cAAA,OAAA,KAAO7B,KAAKJ,MAAMqD,QAAQ5C,SAA1B,KADF,UAGAsB,EAAAC,EAAAC,cAAA,IAAA,KAAI7B,KAAKJ,MAAMqD,QAAQ3C,SACvBqB,EAAAC,EAAAC,cAAA,OAAA,CAAMC,UAAU,uBACb9B,KAAKI,MAAM+D,YAEdxC,EAAAC,EAAAC,cAAA,OAAA,CAAMC,UAAU,iBAAkBS,QAASvC,KAAK0E,oBAAoBxC,KAAKlC,OAAzE,wBAtCcyC,EAAAA,WCAhBkC,8LAQiBF,GAChBzE,KAAKJ,MAAM4E,iBACZxE,KAAKJ,MAAM4E,gBAAgBC,oCAGrB,IAAA5E,EAAAG,KACR,OACG2B,EAAAC,EAAAC,cAAA,MAAA,OACO7B,KAAKJ,MAAMuD,SAAS/B,QAAUpB,KAAKJ,MAAMuD,SAASyB,IAAI,SAAC3B,EAAS4B,GAAV,OAAgBlD,EAAAC,EAAAC,cAACiD,EAAD,CAASC,IAAKF,EAAIJ,MAAOI,EAAG5B,QAASA,EAAUuB,gBAAiB3E,EAAK6E,oBAAoBxC,KAAKrC,eAhBxJ4C,EAAAA,WAApBkC,EAKGjC,aAAe,CACpBS,SAAU,IAeCwB,IAAAA,EAAAA,ECjBTK,+LASAhF,KAAKiF,wDAIL,IAAI9B,EAAWN,aAAaC,QAAQ,aAAe,KACpD,IACGK,EAAWI,KAAK2B,MAAM/B,GACxB,MAAAgC,GACEhC,EAAW,GAEbnD,KAAKJ,MAAMwF,aAAajC,+CAIPsB,GAAO,IACnBtB,EAAanD,KAAKJ,MAAlBuD,SACFC,EAAW,GAAAC,OAAAvD,OAAAwD,EAAA,EAAAxD,CACVqD,EAASkC,MAAM,EAAGZ,IADR3E,OAAAwD,EAAA,EAAAxD,CAEVqD,EAASkC,MAAMZ,EAAQ,KAE5B5B,aAAaG,QAAQ,WAAYO,KAAKC,UAAUJ,IAC5CpD,KAAKJ,MAAM4E,iBACZxE,KAAKJ,MAAM4E,gBAAgBC,oCAI7B,OACE9C,EAAAC,EAAAC,cAACyD,EAAD,CACAnC,SAAUnD,KAAKJ,MAAMuD,SACrBqB,gBAAiBxE,KAAK0E,oBAAoBxC,KAAKlC,eAtCpByC,EAAAA,WAoEpBmB,EAAAA,OAAAA,EAAAA,EAAAA,CAvBS,SAACxD,GACvB,MAAO,CACL+C,SAAU/C,EAAM+C,WAIO,SAACU,GAC1B,MAAO,CAILuB,aAAc,SAACjC,GACbU,EHhCsB,SAACV,GAC3B,MAAO,CAAEa,KAhCW,gBAgCUb,SAAAA,GG+BjBiC,CAAajC,KAGxBqB,gBAAiB,SAACe,GAChB1B,EH3BuB,SAAC0B,GAC5B,MAAO,CAAEvB,KAvCY,iBAuCUuB,aAAAA,GG0BlBC,CAAcD,OAOd3B,CAGboB,GC/DaS,mLARX,OACE9D,EAAAC,EAAAC,cAAA,MAAA,KACEF,EAAAC,EAAAC,cAAC6D,EAAD,MACA/D,EAAAC,EAAAC,cAAC8D,EAAD,cALiBlD,EAAAA,WCInBmD,EAAQC,OAAAA,EAAAA,EAAAA,CLJC,SAAUzF,EAAO0F,GAI9B,OAHK1F,IACFA,EAAQ,CAAE+C,SAAU,KAEf2C,EAAO9B,MAEX,IAVgB,gBAWV,MAAO,CAAEb,SAAU2C,EAAO3C,UAE/B,IAZa,cAaR,MAAO,CACLA,SAAQ,GAAAE,OAAAvD,OAAAwD,EAAA,EAAAxD,CAAMM,EAAM+C,UAAZ,CAAsB2C,EAAO7C,WAG3C,IAhBe,iBAiBX,MAAO,CACHE,SAAQ,GAAAE,OAAAvD,OAAAwD,EAAA,EAAAxD,CACDM,EAAM+C,SAASkC,MAAM,EAAGS,EAAOP,eAD9BzF,OAAAwD,EAAA,EAAAxD,CAEDM,EAAM+C,SAASkC,MAAMS,EAAOP,aAAe,MAG1D,QACI,OAAOnF,KKhBnB2F,EAAAA,EAASC,OACmBrE,EAAAC,EAAAC,cAACoE,EAAA,EAAD,CAAUL,MAAOA,GACbjE,EAAAC,EAAAC,cAACqE,EAAD,OAEJC,SAASC,eAAe\",\"sourcesContent\":[\"import React, { Component } from 'react';\\nimport PropTypes from 'prop-types'\\n\\nclass CommentInput extends Component {\\n  static propTypes = {\\n      username: PropTypes.any,\\n      onSubmit: PropTypes.func,\\n      onUserNameInputBlur: PropTypes.func\\n  }\\n  static defaultProps = {\\n     username: ''\\n  }\\n  constructor (props) {\\n     super(props)\\n     this.state = {\\n        username: props.username,\\n        content: '',\\n        wordCounter: 100\\n     }\\n  }\\n  componentDidMount () {\\n    this.state.username && this.refs.textarea.focus()\\n  }\\n\\n  handleUsernameChange (event) {\\n    this.setState({\\n      username: event.target.value\\n    })\\n  }\\n\\n  handleUsernameBlur (event) {\\n    if (this.props.onUserNameInputBlur) {\\n      this.props.onUserNameInputBlur(event.target.value)\\n    }\\n  }\\n\\n  handleContentChange (e) {\\n    this.refs.textarea.style.height = 'auto'\\n    this.refs.textarea.style.height =  this.refs.textarea.scrollHeight + \\\"px\\\";\\n    this.setState({\\n        content: e.target.value,\\n        wordCounter: 100 - e.target.value.length\\n    })\\n  }\\n  handleSubmit () {\\n     if (this.props.onSubmit) {\\n        this.props.onSubmit({\\n            username: this.state.username,\\n            content: this.state.content, \\n            createdTime:  Math.floor(+Date.now()  / 1000)\\n        })\\n     }\\n     this.setState({content: ''})\\n  }\\n  render () {\\n    return (\\n      <div className='comment-input'>\\n          <div className='comment-field'>\\n            <span className='comment-field-name'>用户名：</span>\\n            <div className='comment-field-input'>\\n              <input \\n                  maxLength= '18'\\n                  value={this.state.username}\\n                  onBlur={this.handleUsernameBlur.bind(this)}\\n                  onChange={this.handleUsernameChange.bind(this)} />\\n            </div>\\n          </div>\\n          <div className='comment-field'>\\n            <span className='comment-field-name'>评论内容：</span>\\n            <div className='comment-field-input'>\\n              <textarea \\n                  maxLength='1000'\\n                  ref=\\\"textarea\\\" \\n                  value={this.state.content}\\n                  onChange={this.handleContentChange.bind(this)} />\\n            </div>\\n          </div>\\n          <div className='word-counter'>{this.state.wordCounter} / 1000</div>\\n          <div className='comment-field-button'>\\n            <button onClick={this.handleSubmit.bind(this)}>\\n              发布\\n            </button>\\n          </div>\\n      </div>\\n    )\\n  }\\n}\\nexport default CommentInput\",\"import React, { Component } from 'react'\\nimport PropTypes from 'prop-types'\\nimport { connect } from 'react-redux'\\nimport CommentInput from './CommentInput'\\nimport { addComment } from '../reducers/comments'\\n\\nclass CommentInputContainer extends Component {\\n    static propTypes = {\\n      comments: PropTypes.array,\\n      onSubmit: PropTypes.func\\n    }\\n\\n    constructor () {\\n       super()\\n       this.state = {\\n          username: ''\\n       }\\n    }\\n\\n    componentWillMount () {\\n        this._loadUsername()\\n    }\\n\\n    _loadUsername () {\\n        let username = localStorage.getItem('username')\\n        username && this.setState({username})\\n    }\\n\\n    // 失去焦点保存名字\\n    _saveUsername (username) {\\n      let oldUserName = localStorage.getItem('username') || ''\\n      username && oldUserName !== username &&  localStorage.setItem('username', username)\\n    }\\n\\n    handleSubmitComment (comment) {\\n      if (!comment) return\\n      if (!comment.username) return alert('请输入用户名')\\n      if (!comment.content) return alert('请输入评论内容')\\n        const { comments } = this.props\\n        const newComments = [...comments, comment]\\n        localStorage.setItem('comments', JSON.stringify(newComments))\\n        if (this.props.onSubmit) {\\n            this.props.onSubmit(comment)\\n        }\\n    }\\n    render () {\\n      return(\\n        <CommentInput \\n        username={this.state.username}\\n        onUserNameInputBlur={this._saveUsername.bind(this)}\\n        onSubmit={this.handleSubmitComment.bind(this)} />\\n      )\\n    }\\n}\\n\\n\\nconst mapStateToProps = (state) => {\\n  return {\\n    comments: state.comments\\n  }\\n}\\n\\nconst mapDispatchToProps = (dispatch) => {\\n  return {\\n    onSubmit: (comment) => {\\n      dispatch(addComment(comment))\\n    }\\n  }\\n}\\n\\nexport default connect(\\n  mapStateToProps,\\n  mapDispatchToProps\\n)(CommentInputContainer)\",\"// action types\\nconst INIT_COMMENTS = 'INIT_COMMENTS'\\nconst ADD_COMMENT = 'ADD_COMMENT'\\nconst DELETE_COMMENT = 'DELETE_COMMENT'\\n\\nexport default function (state, action) {\\n  if (!state) {\\n     state = { comments: [] }\\n  }\\n  switch (action.type) {\\n        // 初始化评论\\n      case INIT_COMMENTS:\\n            return { comments: action.comments }\\n        // 新增评论\\n       case ADD_COMMENT:\\n            return {\\n              comments: [...state.comments, action.comment]\\n            }     \\n        // 删除评论\\n        case DELETE_COMMENT:\\n            return {\\n                comments: [\\n                    ...state.comments.slice(0, action.commentIndex),\\n                    ...state.comments.slice(action.commentIndex + 1)\\n                ]\\n            }\\n        default:\\n            return state    \\n  }\\n}\\n\\n// action creators\\nexport const initComments = (comments) => {\\n  return { type: INIT_COMMENTS, comments }\\n}\\n\\nexport const addComment = (comment) => {\\n  console.log(comment)\\n  return { type: ADD_COMMENT, comment }\\n}\\n\\nexport const deleteComment = (commentIndex) => {\\n  return { type: DELETE_COMMENT, commentIndex }\\n}\",\"import React, { Component } from 'react';\\nimport PropTypes from  'prop-types'\\n\\nclass Comment extends Component {\\n  static propTypes = {\\n    comment: PropTypes.object.isRequired,\\n    onDeleteComment: PropTypes.func,\\n    index: PropTypes.number\\n  }\\n  constructor () {\\n    super()\\n    this.state = {\\n        timeString: ''\\n    }\\n  }\\n  componentWillMount () {\\n      this._updateTimeString()\\n  }\\n  _updateTimeString  () {\\n    const comment = this.props.comment\\n    const duration = Math.floor(+Date.now() / 1000 - comment.createdTime)\\n    console.log(duration)\\n    this.setState({\\n      timeString: duration > 60 ?  (duration > 60 * 60 ? (duration > 60 * 60 * 24 ? `${Math.round(duration / 60 / 60 / 24)} 天前` : `${Math.round(duration / 60 / 60)} 小时前`)  : `${Math.round(duration / 60)} 分钟前`) : `${Math.round(Math.max(duration, 1))} 秒前`\\n    })\\n  }\\n  handleDeleteComment () {\\n      if (this.props.onDeleteComment) {\\n        this.props.onDeleteComment(this.props.index)\\n      }\\n  }\\n  render () {\\n    return (\\n      <div className='comment'>\\n        <div className='comment-user'>\\n          <span>{this.props.comment.username} </span>：\\n        </div>\\n        <p>{this.props.comment.content}</p>\\n        <span className='comment-createdtime'>\\n          {this.state.timeString}\\n        </span>\\n        <span className='comment-delete'  onClick={this.handleDeleteComment.bind(this)}>\\n          删除\\n        </span>\\n      </div>\\n    )\\n  }\\n}\\nexport default Comment\",\"import React, { Component } from 'react';\\nimport Comment from './Comment'\\nimport PropTypes from 'prop-types'\\nclass CommentList extends Component {\\n  static propTypes = {\\n    comments: PropTypes.array,\\n    onDeleteComment: PropTypes.func\\n  }\\n  static defaultProps = {\\n    comments: []\\n  }\\n  handleDeleteComment (index) {\\n    if(this.props.onDeleteComment) {\\n      this.props.onDeleteComment(index)\\n    }\\n  }\\n  render () {\\n    return (\\n       <div>\\n         {  !!this.props.comments.length && this.props.comments.map((comment, i) => <Comment key={i}  index={i} comment={comment}  onDeleteComment={this.handleDeleteComment.bind(this)}/>)}\\n       </div>\\n    )\\n  }\\n}\\nexport default CommentList\",\"import React, { Component } from 'react'\\nimport PropTypes from 'prop-types'\\nimport { connect } from 'react-redux'\\nimport CommentList from './CommentList'\\nimport { initComments, deleteComment } from '../reducers/comments'\\n\\n\\nclass CommentListContainer extends Component {\\n  static propTypes = {\\n    comments: PropTypes.array,\\n    initComments: PropTypes.func,\\n    onDeleteComment: PropTypes.func\\n  }\\n  \\n  // 初始化评论列表\\n  componentWillMount () {\\n      this._loadComments()\\n  }\\n\\n  _loadComments () {\\n      let comments = localStorage.getItem('comments') || '[]'\\n     try {\\n        comments = JSON.parse(comments)\\n     }catch{\\n        comments = []\\n     }\\n      this.props.initComments(comments)\\n  }\\n  \\n  //删除评论\\n  handleDeleteComment (index) {\\n     let { comments } = this.props\\n     let newComments = [\\n       ...comments.slice(0, index),\\n       ...comments.slice(index + 1)\\n     ]\\n     localStorage.setItem('comments', JSON.stringify(newComments))\\n     if (this.props.onDeleteComment) {\\n        this.props.onDeleteComment(index)\\n     }\\n  }\\n  render () {\\n      return(\\n        <CommentList\\n        comments={this.props.comments}\\n        onDeleteComment={this.handleDeleteComment.bind(this)} />\\n      )\\n  }\\n\\n}\\n\\n// 评论列表从 state.comments 中获取\\nconst mapStateToProps = (state) => {\\n  return {\\n    comments: state.comments\\n  }\\n}\\n\\nconst mapDispatchToProps = (dispatch) => {\\n  return {\\n    // 提供给 CommentListContainer\\n    // 当从 LocalStorage 加载评论列表以后就会通过这个方法\\n    // 把评论列表初始化到 state 当中\\n    initComments: (comments) => {\\n      dispatch(initComments(comments))\\n    },\\n    // 删除评论\\n    onDeleteComment: (commentIndex) => {\\n      dispatch(deleteComment(commentIndex))\\n    }\\n  }\\n}\\n\\n// 将 CommentListContainer connect 到 store\\n// 会把 comments、initComments、onDeleteComment 传给 CommentListContainer\\nexport default connect(\\n  mapStateToProps,\\n  mapDispatchToProps\\n)(CommentListContainer)\",\"import React, { Component } from 'react'\\nimport CommentInput from './CommentInputContainer'\\nimport CommentList from './CommentListContainer'\\n\\n\\nclass CommentApp extends Component {\\n  render () {\\n    return (\\n      <div>\\n        <CommentInput  />\\n        <CommentList />\\n      </div>\\n    )\\n  }\\n}\\nexport default CommentApp\",\"import React from 'react';\\nimport ReactDOM from 'react-dom';\\nimport './index.css';\\nimport './App.css';\\nimport { createStore } from 'redux'\\nimport { Provider } from 'react-redux'\\nimport CommentApp from './Comment/CommentApp'\\nimport commentsReducer from './reducers/comments'\\n\\nconst store = createStore(commentsReducer)\\n\\nReactDOM.render(  \\n                            <Provider store={store}>\\n                                <CommentApp />\\n                            </Provider>, \\n                            document.getElementById('root')\\n);\\n\\n// If you want your app to work offline and load faster, you can change\\n// unregister() to register() below. Note this comes with some pitfalls.\\n// Learn more about service workers: http://bit.ly/CRA-PWA\\n// serviceWorker.unregister();\\n\"]}","code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{18:function(e,t,n){e.exports=n(31)},23:function(e,t,n){},25:function(e,t,n){},31:function(e,t,n){\"use strict\";n.r(t);var a=n(0),o=n.n(a),m=n(16),s=n.n(m),c=(n(23),n(25),n(10)),r=n(8),i=n(1),l=n(2),u=n(4),h=n(3),p=n(5),d=n(6),f=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(h.a)(t).call(this,e))).state={username:e.username,content:\"\",wordCounter:100},n}return Object(p.a)(t,e),Object(l.a)(t,[{key:\"componentDidMount\",value:function(){this.state.username&&this.refs.textarea.focus()}},{key:\"handleUsernameChange\",value:function(e){this.setState({username:e.target.value})}},{key:\"handleUsernameBlur\",value:function(e){this.props.onUserNameInputBlur&&this.props.onUserNameInputBlur(e.target.value)}},{key:\"handleContentChange\",value:function(e){this.refs.textarea.style.height=\"auto\",this.refs.textarea.style.height=this.refs.textarea.scrollHeight+\"px\",this.setState({content:e.target.value,wordCounter:100-e.target.value.length})}},{key:\"handleSubmit\",value:function(){this.props.onSubmit&&this.props.onSubmit({username:this.state.username,content:this.state.content,createdTime:Math.floor(+Date.now()/1e3)}),this.setState({content:\"\"})}},{key:\"render\",value:function(){return o.a.createElement(\"div\",{className:\"comment-input\"},o.a.createElement(\"div\",{className:\"comment-field\"},o.a.createElement(\"span\",{className:\"comment-field-name\"},\"\\u7528\\u6237\\u540d\\uff1a\"),o.a.createElement(\"div\",{className:\"comment-field-input\"},o.a.createElement(\"input\",{maxLength:\"18\",value:this.state.username,onBlur:this.handleUsernameBlur.bind(this),onChange:this.handleUsernameChange.bind(this)}))),o.a.createElement(\"div\",{className:\"comment-field\"},o.a.createElement(\"span\",{className:\"comment-field-name\"},\"\\u8bc4\\u8bba\\u5185\\u5bb9\\uff1a\"),o.a.createElement(\"div\",{className:\"comment-field-input\"},o.a.createElement(\"textarea\",{maxLength:\"1000\",ref:\"textarea\",value:this.state.content,onChange:this.handleContentChange.bind(this)}))),o.a.createElement(\"div\",{className:\"word-counter\"},this.state.wordCounter,\" / 1000\"),o.a.createElement(\"div\",{className:\"comment-field-button\"},o.a.createElement(\"button\",{onClick:this.handleSubmit.bind(this)},\"\\u53d1\\u5e03\")))}}]),t}(a.Component);f.defaultProps={username:\"\"};var b=f,v=function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(u.a)(this,Object(h.a)(t).call(this))).state={username:\"\"},e}return Object(p.a)(t,e),Object(l.a)(t,[{key:\"componentWillMount\",value:function(){this._loadUsername()}},{key:\"_loadUsername\",value:function(){var e=localStorage.getItem(\"username\");e&&this.setState({username:e})}},{key:\"_saveUsername\",value:function(e){var t=localStorage.getItem(\"username\")||\"\";e&&t!==e&&localStorage.setItem(\"username\",e)}},{key:\"handleSubmitComment\",value:function(e){if(e){if(!e.username)return alert(\"\\u8bf7\\u8f93\\u5165\\u7528\\u6237\\u540d\");if(!e.content)return alert(\"\\u8bf7\\u8f93\\u5165\\u8bc4\\u8bba\\u5185\\u5bb9\");var t=this.props.comments,n=[].concat(Object(d.a)(t),[e]);localStorage.setItem(\"comments\",JSON.stringify(n)),this.props.onSubmit&&this.props.onSubmit(e)}}},{key:\"render\",value:function(){return o.a.createElement(b,{username:this.state.username,onUserNameInputBlur:this._saveUsername.bind(this),onSubmit:this.handleSubmitComment.bind(this)})}}]),t}(a.Component),O=Object(r.b)(function(e){return{comments:e.comments}},function(e){return{onSubmit:function(t){e(function(e){return console.log(e),{type:\"ADD_COMMENT\",comment:e}}(t))}}})(v),C=function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(u.a)(this,Object(h.a)(t).call(this))).state={timeString:\"\"},e}return Object(p.a)(t,e),Object(l.a)(t,[{key:\"componentWillMount\",value:function(){this._updateTimeString()}},{key:\"_updateTimeString\",value:function(){var e=this.props.comment,t=Math.floor(+Date.now()/1e3-e.createdTime);console.log(t),this.setState({timeString:t>60?t>3600?t>86400?\"\".concat(Math.round(t/60/60/24),\" \\u5929\\u524d\"):\"\".concat(Math.round(t/60/60),\" \\u5c0f\\u65f6\\u524d\"):\"\".concat(Math.round(t/60),\" \\u5206\\u949f\\u524d\"):\"\".concat(Math.round(Math.max(t,1)),\" \\u79d2\\u524d\")})}},{key:\"handleDeleteComment\",value:function(){this.props.onDeleteComment&&this.props.onDeleteComment(this.props.index)}},{key:\"render\",value:function(){return o.a.createElement(\"div\",{className:\"comment\"},o.a.createElement(\"div\",{className:\"comment-user\"},o.a.createElement(\"span\",null,this.props.comment.username,\" \"),\"\\uff1a\"),o.a.createElement(\"p\",null,this.props.comment.content),o.a.createElement(\"span\",{className:\"comment-createdtime\"},this.state.timeString),o.a.createElement(\"span\",{className:\"comment-delete\",onClick:this.handleDeleteComment.bind(this)},\"\\u5220\\u9664\"))}}]),t}(a.Component),E=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:\"handleDeleteComment\",value:function(e){this.props.onDeleteComment&&this.props.onDeleteComment(e)}},{key:\"render\",value:function(){var e=this;return o.a.createElement(\"div\",null,!!this.props.comments.length&&this.props.comments.map(function(t,n){return o.a.createElement(C,{key:n,index:n,comment:t,onDeleteComment:e.handleDeleteComment.bind(e)})}))}}]),t}(a.Component);E.defaultProps={comments:[]};var j=E,g=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:\"componentWillMount\",value:function(){this._loadComments()}},{key:\"_loadComments\",value:function(){var e=localStorage.getItem(\"comments\")||\"[]\";try{e=JSON.parse(e)}catch(t){e=[]}this.props.initComments(e)}},{key:\"handleDeleteComment\",value:function(e){var t=this.props.comments,n=[].concat(Object(d.a)(t.slice(0,e)),Object(d.a)(t.slice(e+1)));localStorage.setItem(\"comments\",JSON.stringify(n)),this.props.onDeleteComment&&this.props.onDeleteComment(e)}},{key:\"render\",value:function(){return o.a.createElement(j,{comments:this.props.comments,onDeleteComment:this.handleDeleteComment.bind(this)})}}]),t}(a.Component),y=Object(r.b)(function(e){return{comments:e.comments}},function(e){return{initComments:function(t){e(function(e){return{type:\"INIT_COMMENTS\",comments:e}}(t))},onDeleteComment:function(t){e(function(e){return{type:\"DELETE_COMMENT\",commentIndex:e}}(t))}}})(g),S=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:\"render\",value:function(){return o.a.createElement(\"div\",null,o.a.createElement(O,null),o.a.createElement(y,null))}}]),t}(a.Component),k=Object(c.b)(function(e,t){switch(e||(e={comments:[]}),t.type){case\"INIT_COMMENTS\":return{comments:t.comments};case\"ADD_COMMENT\":return{comments:[].concat(Object(d.a)(e.comments),[t.comment])};case\"DELETE_COMMENT\":return{comments:[].concat(Object(d.a)(e.comments.slice(0,t.commentIndex)),Object(d.a)(e.comments.slice(t.commentIndex+1)))};default:return e}});s.a.render(o.a.createElement(r.a,{store:k},o.a.createElement(S,null)),document.getElementById(\"root\"))}},[[18,2,1]]]);","extractedComments":[]}